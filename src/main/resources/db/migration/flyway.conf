# Flyway Configuration for Chatwoot Multi-tenant System
# This file configures Flyway to properly handle database migrations

# Database connection
flyway.url=${DATABASE_URL}
flyway.user=${DATABASE_USERNAME}
flyway.password=${DATABASE_PASSWORD}

# Migration settings
flyway.locations=classpath:db/migration
flyway.baselineOnMigrate=true
flyway.validateOnMigrate=true
flyway.cleanDisabled=false
flyway.cleanOnValidationError=false

# Schema management
flyway.schemas=public
flyway.defaultSchema=public
flyway.createSchemas=true

# Migration naming convention
flyway.sqlMigrationPrefix=V
flyway.sqlMigrationSeparator=__
flyway.sqlMigrationSuffixes=.sql

# Execution settings
flyway.ignoreMigrationPatterns=*:missing
flyway.mixed=false
flyway.group=false
flyway.installedBy=chatwoot-system

# Logging
flyway.loggers=slf4j
flyway.verbose=true

# Placeholder replacement
flyway.placeholderReplacement=true
flyway.placeholders.tenant_prefix=wc_
flyway.placeholders.app_name=chatwoot

# Clean settings (for development only)
flyway.cleanDisabled=false
flyway.cleanOnValidationError=false

# Out of order migrations (allow if needed)
flyway.outOfOrder=false

# Encoding
flyway.encoding=UTF-8

# Table creation
flyway.createSchemas=true
flyway.initSql=CREATE SCHEMA IF NOT EXISTS public;

# Migration history table
flyway.table=flyway_schema_history
flyway.baselineVersion=0
flyway.baselineDescription=Initial baseline

# Repeatable migrations
flyway.repeatableSqlMigrationPrefix=R
flyway.repeatableSqlMigrationSeparator=__
flyway.repeatableSqlMigrationSuffixes=.sql

# Undo migrations (if supported)
flyway.undoSqlMigrationPrefix=U
flyway.undoSqlMigrationSeparator=__
flyway.undoSqlMigrationSuffixes=.sql

# Callbacks
flyway.callbacks=
flyway.callbacksResolvers=

# Jdbc drivers
flyway.driver=org.postgresql.Driver

# Connection timeout
flyway.connectRetries=3
flyway.connectRetriesInterval=1

# Statement timeout
flyway.statementTimeout=300

# Batch size for statements
flyway.batch=true
flyway.batchSize=100

# Dry run mode (for validation)
flyway.dryRunOutput=update

# Stream mode
flyway.stream=false

# Kerberos configuration (if needed)
flyway.kerberosConfigFile=

# Oracle specific settings
flyway.oracle.sqlplus=false
flyway.oracle.sqlplusWarn=false

# SQL Server specific settings
flyway.sqlserver.kerberosLoginFile=

# MySQL specific settings
flyway.mysql.connectionTimeout=30000

# PostgreSQL specific settings
flyway.postgresql.connectionTimeout=30000
flyway.postgresql.socketTimeout=30000
flyway.postgresql.socketTimeoutInterval=1000

# Redshift specific settings
flyway.redshift.connectionTimeout=30000
flyway.redshift.socketTimeout=30000
flyway.redshift.socketTimeoutInterval=1000

# Snowflake specific settings
flyway.snowflake.connectionTimeout=30000
flyway.snowflake.socketTimeout=30000
flyway.snowflake.socketTimeoutInterval=1000

# BigQuery specific settings
flyway.bigquery.connectionTimeout=30000
flyway.bigquery.socketTimeout=30000
flyway.bigquery.socketTimeoutInterval=1000

# CockroachDB specific settings
flyway.cockroachdb.connectionTimeout=30000
flyway.cockroachdb.socketTimeout=30000
flyway.cockroachdb.socketTimeoutInterval=1000

# YugabyteDB specific settings
flyway.yugabytedb.connectionTimeout=30000
flyway.yugabytedb.socketTimeout=30000
flyway.yugabytedb.socketTimeoutInterval=1000
